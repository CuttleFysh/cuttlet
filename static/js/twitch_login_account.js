location.search&&window.location.replace("/");for(var query_string=location.hash.substring(1),params={},regex=/([^&=]+)=([^&]*)/g,m;m=regex.exec(query_string);)params[decodeURIComponent(m[1])]=decodeURIComponent(m[2]),requestChannelId(params);
function requestChannelId(b){if(b.access_token&&b.scope){var a=new XMLHttpRequest;api_endpoint="https://api.twitch.tv/kraken/user?client_id=jyxzi98m2x4l2cho0gairq05gsb3uq";a.open("GET",api_endpoint);a.setRequestHeader("Authorization","OAuth "+b.access_token);a.onreadystatechange=function(b){if(4==a.readyState&&200==a.status&&a.responseText){b=JSON.parse(a.response)._id;var c=JSON.parse(a.response).name,d=JSON.parse(a.response).logo;d||(d="");loginTwitchChannel(b,c,d)}};a.send(null)}}
function loginTwitchChannel(b,a,e){var c=new XMLHttpRequest,d=window.location.href;b="twitch_id="+b+"&channel_name="+a+"&thumbnail_url="+e+"&csrfmiddlewaretoken="+document.getElementsByName("csrfmiddlewaretoken")[0].value;c.open("POST",d);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.onreadystatechange=function(a){4==c.readyState&&200==c.status&&window.location.replace("/")};c.send(b)};
