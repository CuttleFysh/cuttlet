var chat=new CuttleChat,leaderboard=[],explanation=document.getElementById("explanation"),input_answer=document.getElementById("input_answer"),button_show=document.getElementById("button_show"),button_start=document.getElementById("button_start"),button_next_question=document.getElementById("button_next_question"),content_correctboard=document.getElementById("content_correctboard"),content_leaderboard=document.getElementById("content_leaderboard");
button_show.addEventListener("click",toggleViewAnswer,!1);button_start.addEventListener("click",startReading,!1);button_next_question.addEventListener("click",nextQuestion,!1);function toggleViewAnswer(){"text"===input_answer.type?(input_answer.type="password",button_show.innerHTML="SHOW"):(input_answer.type="text",button_show.innerHTML="HIDE")}function limitIndex(b,a){return b<=a?b:a}
function updateLeaderboard(){var b=1;content_leaderboard.innerHTML="";leaderboard.sort(function(a,b){return b.points-a.points});for(var a=0;a<limitIndex(leaderboard.length,5);a++){var c=document.createElement("span");c.className="rank_user";c.innerHTML=b+". "+leaderboard[a].username;var g=document.createElement("span");g.className="rank_points";g.innerHTML=leaderboard[a].points;content_leaderboard.appendChild(c);content_leaderboard.appendChild(g);b++}}
function startReading(){if(""===input_answer.value)input_answer.placeholder="Please write the correct answer";else{input_answer.type="password";input_answer.readOnly=!0;button_show.innerHTML="SHOW";var b=input_answer.value.toLowerCase(),a=[],c=1,g=new Date;chat.open(function(f,h){var d=a.indexOf(f);h=h.toLowerCase();if(-1===d&&h==b){d=(new Date).getTime()-g.getTime();d=Math.round(3E5/d+1E3/c);a.push(f);var e=document.createElement("span");e.className="rank_user";e.innerHTML=c+". "+f;var k=document.createElement("span");
k.className="rank_points";k.innerHTML=d;content_correctboard.appendChild(e);content_correctboard.appendChild(k);c++;e=leaderboard.findIndex(function(a){return a.username===f});0<=e?leaderboard[e].points+=d:leaderboard.push({username:f,points:d});updateLeaderboard();5==a.length&&(explanation.innerHTML="Fastest responses found!",chat.close())}});explanation.innerHTML="Waiting for correct responses";button_start.style.display="none";button_next_question.style.display="inline-block"}}
function nextQuestion(){chat.close();input_answer.value="";input_answer.placeholder="Write the correct answer";input_answer.readOnly=!1;input_answer.type="password";button_show.innerHTML="SHOW";content_correctboard.innerHTML="";button_next_question.style.display="none";button_start.style.display="inline-block";explanation.innerHTML="Think of a question"};
