for(var query_string=location.hash.substring(1),params={},regex=/([^&=]+)=([^&]*)/g,m;m=regex.exec(query_string);)params[decodeURIComponent(m[1])]=decodeURIComponent(m[2]),exchangeOAuth2Token(params);
function exchangeOAuth2Token(b){if(b.access_token&&b.token_type&&b.expires_in){var a=new XMLHttpRequest;a.open("POST","https://www.googleapis.com/oauth2/v3/tokeninfo?access_token="+b.access_token);a.onreadystatechange=function(c){c=JSON.parse(a.response);4==a.readyState&&200==a.status&&c.aud&&"1050192004499-8r20tm8rqaek1p9ej4g8vr8ubekkfbms.apps.googleusercontent.com"==c.aud&&requestChannelId(b.access_token)};a.send(null)}else b.error&&window.location.replace("/")}
function requestChannelId(b){var a=new XMLHttpRequest;api_endpoint="https://www.googleapis.com/youtube/v3/channels?part=snippet&mine=true&";a.open("GET",api_endpoint+"access_token="+b);a.onreadystatechange=function(b){if(4==a.readyState&&200==a.status&&a.responseText){b=JSON.parse(a.response).items[0].id;var d=JSON.parse(a.response).items[0].snippet.title,c=JSON.parse(a.response).items[0].snippet.thumbnails["default"].url;c||(c="");loginYoutubeChannel(b,d,c)}};a.send(null)}
function loginYoutubeChannel(b,a,c){var d=new XMLHttpRequest,e=window.location.href;b="youtube_id="+b+"&channel_name="+a+"&thumbnail_url="+c+"&csrfmiddlewaretoken="+document.getElementsByName("csrfmiddlewaretoken")[0].value;d.open("POST",e);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.onreadystatechange=function(a){4==d.readyState&&200==d.status&&window.location.replace("/")};d.send(b)};
